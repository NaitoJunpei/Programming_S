<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <style type="text/css">
    body,td,th {font-size:10pt}
  </style>
  
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<META name="GENERATOR" content="IBM WebSphere Studio Homepage Builder Version 13.0.6.0 for Windows">
<META http-equiv="Content-Style-Type" content="text/css">
<link rel="stylesheet" href="hist.css" type="text/css">
	<script type="text/javascript" src="mt.js"></script>
	<script type="text/javascript" src="hmm_funcs.js"></script>
	<script type="text/javascript" src="hist.js"></script>
	<script type="text/javascript" src="SulabApplet1.js"></script>
	<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
	<script type="text/javascript">
	  google.charts.load('current', {'packages' :['corechart']}); //GoogleChartsが使えるようになる
	</script>

	<script type="text/javascript">
	  if (window.File && window.FileReader && window.FileList && window.Blob) {
	  // Great success! All the File APIs are supported.
	  } else {
	    alert('The File APIs are not fully supported in this browser.');
	  }
	</script>
	
	<title>Histogram Optimization</title>
	<script type="text/javascript" src="Output.js"></script>
</HEAD>

<BODY onLoad="Initialize()" style="font-family:Optima,Arial">

<div style="width:920" id="Main">
		
		
	<!-- Header -->
	<h2>Toolbox: Estimating the firing rate</h2>
	
	<!-- Web Application -->
	<div id="contents">
	<FORM name="data">
		<font face="Arial Black"><strong>1. You can paste your data here, </strong></font>&nbsp;&nbsp;
		<INPUT type="button" value=" or, replace it with another sample," onclick="ResetData()" id="test"> or, upload your data <INPUT type="file" id="selfile" style="display:none"><INPUT type="button" value="upload" onClick="document.getElementById('selfile').click()"<br>
		<script type="text/javascript">
		  function handleFileSelect(evt) {
		    var file = evt.target.files;
		    var reader = new FileReader();
		    reader.readAsText(file[0]);
		    reader.onload = function(ev) {
		      document.data.spikes.value = reader.result;
		      Main();
		    }
		  }
		  document.getElementById('selfile').addEventListener('change', handleFileSelect, false);
		</script>
		
		&nbsp;&nbsp;&nbsp;&nbsp;<TEXTAREA name="spikes" rows="3" cols="95" font="3" onChange="Main()"></TEXTAREA><br>
		&nbsp;&nbsp;&nbsp;&nbsp;Please list spike times in increasing order, separated by a comma or a space.<br>
		&nbsp;&nbsp;&nbsp;&nbsp;Your data would not leak out, because the computation is carried out by your computer.<br><br>
		
		<font face="Arial Black"><strong>2.Estimate the firing rate</strong></font>
		<INPUT type="button" value="Estimate the rate" onclick="" ><br>

		<!-- ShimazakiShinomoto -->
		&nbsp;&nbsp;&nbsp;&nbsp;(A) Histogram: L2 risk minimization [1]<br>
		<div id="graph_SS" class="graph"></div>
		<div id="raster" class="raster"></div>
		<Myleft>Optimal binsize =
		<p id="optimal_SS" class="value"></p>.
		<INPUT type="button" value="data sheet" id="outputSS">
		<INPUT type="button" value="more detail" onClick=window.open('http://www.ton.scphys.kyoto-u.ac.jp/~shino/toolbox/sshist/hist.html')></Myleft><br>

		<!-- OmiShinomoto -->
		&nbsp;&nbsp;&nbsp;&nbsp;(B) Histogram: L2 risk minimization for non-Poisson spike trains [2]<br>
		<div id="graph_OS" class="graph"></div>
		<div id="raster2" class="raster"></div>
		<Myleft>Optimal binsize = 
		<p id="optimal_OS1" class="value"></p>.
		Irregularity is estimated as Lv =
		<p id="optimal_OS2" class="value"></p>.
		<INPUT type="button" value="data sheet" id="outputOS">
		<INPUT type="button" value="more detail" onClick=window.open('http://www.ton.scphys.kyoto-u.ac.jp/~shino/toolbox/oshist/hist.html')></Myleft><br>

		<!-- Kernel Density Estimation -->
		&nbsp;&nbsp;&nbsp;&nbsp;(C) Kernel density estimation: L2 risk minimization [3]<br>
		<div id="ShimazakiKernel" class="graph"></div>
		<div id="raster3" class="raster"></div>
		<Myleft>Optimal bandwidth = 
		<p id="optimal_ShimazakiKernel" class="value"></p>.
		<INPUT type="button" value="data sheet" id="outputSSKernel">
		<INPUT type="button" value="more detail" onClick=window.open('http://www.ton.scphys.kyoto-u.ac.jp/~shino/toolbox/sskernel/kernel.html')></Myleft><br>

		<!-- Kernel Density Estimation Reflection -->
		&nbsp;&nbsp;&nbsp;&nbsp;(D) Kernel density estimation: L2 risk minimization, reflection boundary.<br>		
		<div id="ShimazakiKernelR" class="graph"></div>
		<div id="raster4" class="raster"></div>
		<Myleft>Optimal bandwidth = 
		<p id="optimal_ShimazakiKernelR" class="value"></p>.
		<INPUT type="button" value="data sheet" id="outputSSKernelR">
		<INPUT type="button" value="more detail" onClick=window.open('http://www.ton.scphys.kyoto-u.ac.jp/~shino/toolbox/reflectedkernel/reflectedkernel.html')></Myleft><br>


		&nbsp;&nbsp;&nbsp;&nbsp;(E) Bayesian rate estimation [4][5]<br>
		<div id="Bayes" class="graph"></div>
		<div id="raster6" class="raster"></div>
		<INPUT type="button" value="data sheet" id="">
		<INPUT type="button" value="more detail(1)" onClick=window.open('http://www.ton.scphys.kyoto-u.ac.jp/~shino/toolbox/ssBayes/bayes.html')>
		<INPUT type="button" value="more detail(2)" onClick=window.open('http://www.ton.scphys.kyoto-u.ac.jp/~shino/toolbox/ssNeCo09/page_SULAB2.html')><br>
		&nbsp;&nbsp;&nbsp;&nbsp;(F) Two-state Hidden Markov Model [6]<br>
		<div id="HMM" class="graph"></div>
		<div id = "raster5" class="raster"></div>
		<Myleft>
		<p id="HMMMessage" class="value"></p>
		<INPUT type="button" value="data sheet" id="outputHMM">
		<INPUT type="button" value="more detail" onClick=window.open('http://www.ton.scphys.kyoto-u.ac.jp/~shino/toolbox/msHMM/HMM.html')>
		</Myleft>
	</FORM>
	<HR width="920" align="left">
	
	
	<!-- Formula --> 
	
	<!-- Contact --><FONT size="-1">[1] Shimazaki H and Shinomoto S (2007) A method for selecting the bin size of a time histogram. Neural Computation 19:1503-1700.<br>
[2] Omi T and Shinomoto S (2011) Optimizing time histograms for non-Poissonian spike trains. Neural Computation 23:3125-3144.<br>
[3] Shimazaki H and Shinomoto S (2010) Kernel bandwidth optimization in spike rate estimation. J. Computational Neuroscience 29:171-182.<br>
	  [4] Koyama S and Shinomoto S (2005) Empirical Bayes interpretations of random point events. J. Phys. A 38:L531-L537.<br>
	  [5] Shimokawa T and Shinomoto S (2009) Estimating instantaneous irregularity of neuronal firing. Neural Computation 21: 1931-1951.<br>
	  [6] Mochizuki Y and Shinomoto S (2014) Analog and digital codes in the brain. Physical Review E 89:022705.
	  </FONT><BR>
	</div>
	
</div>
<div style="width:920" id="Output">
  <!-- 出力用の場所 data sheetボタンを押した時だけ見える -->
  <INPUT type="button" value="back" onclick="backMain()" style="font-size:10pt"><br>
  <p id="OutputMessage" style=font-size:10pt></p>
  <INPUT type="button" value="back" onclick="backMain()" style="font-size:10pt"><br>
</BODY>

</html> 

